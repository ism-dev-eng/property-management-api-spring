apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

# Reference the base configuration
resources:
  - ../../base

# Override namespace for DEV environment
namespace: property-management-dev

# Override labels (fix deprecation warning)
labels:
  - includeSelectors: true
    pairs:
      app: property-management-api
      environment: dev
      managed-by: kustomize

# Patch ConfigMap using modern syntax
patches:
  - target:
      kind: ConfigMap
      name: app-config
    patch: |-
      - op: add
        path: /data/SPRING_PROFILES_ACTIVE
        value: "dev"
      - op: add
        path: /data/LOGGING_LEVEL_ROOT
        value: "DEBUG"
      - op: replace
        path: /data/SPRING_JPA_HIBERNATE_DDL_AUTO
        value: "update"

# Override replicas for DEV (1 replica for development)
replicas:
  - name: app
    count: 1

# Override image tag for DEV
images:
  - name: property-management-api
    newTag: dev-latest